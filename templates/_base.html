<!doctype html>
<html
    lang="{{ lang.as_str() }}"
    data-theme="pastel"
    class="scroll-smooth transition-colors duration-300"
>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <script>
            (function(){var t=localStorage.getItem("theme");if(t==="dark"||t==="pastel-dark"||((!t)&&window.matchMedia("(prefers-color-scheme:dark)").matches)){document.documentElement.setAttribute("data-theme","pastel-dark")}})();
            window.addEventListener("scroll",function(){var h=document.querySelector("header");if(h){if(window.scrollY>10)h.classList.add("shadow-md");else h.classList.remove("shadow-md")}},{passive:true});
        </script>
        <link rel="preconnect" href="https://unpkg.com" crossorigin>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <script src="https://unpkg.com/@phosphor-icons/web"></script>
        <script src="/assets/js/app.js?v={{ blog.v }}" defer></script>
        <script src="https://unpkg.com/htmx.org@2.0.2" async></script>
        <link
            href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;500;600;700&family=Gowun+Dodum&family=Zen+Maru+Gothic:wght@300;400;500;700&family=JetBrains+Mono:wght@400;500&display=swap"
            rel="stylesheet"
            media="print" onload="this.media='all'"
        />
        <noscript>
            <link
                href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;500;600;700&family=Gowun+Dodum&family=Zen+Maru+Gothic:wght@300;400;500;700&family=JetBrains+Mono:wght@400;500&display=swap"
                rel="stylesheet"
            />
        </noscript>
        <link href="/assets/styles/tailwind.output.css?v={{ blog.v }}" rel="stylesheet" />
        <link
            rel="stylesheet"
            href="/assets/styles/print.css?v={{ blog.v }}"
            media="print"
        />
        <!-- Atom feed autodiscovery -->
        <link rel="alternate" type="application/atom+xml" title="miniex.blog" href="/feed.xml" />
        <!-- each page -->
        {% block head %}{% endblock %}
        <!-- favicon -->
        <link rel="apple-touch-icon" sizes="152x152" href="/assets/favicon/sakura-flower-152-238032.png" />
        <link rel="icon" type="image/png" sizes="152x152" href="/assets/favicon/sakura-flower-152-238032.png" />
        <link rel="shortcut icon" href="/assets/favicon/favicon.ico" />
        <!-- SEO keywords -->
        <meta name="keywords" content="Rust, JavaScript, web development, programming, blog, miniex, tutorial, server, app development" />
    </head>

    <body
        class="flex flex-col min-h-screen bg-base-100 font-['Nunito','Gowun_Dodum','Zen_Maru_Gothic',system-ui,sans-serif] text-base-content antialiased selection:bg-primary/15 selection:text-base-content"
    >
        <a href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-2 focus:left-2 focus:z-50 focus:bg-base-100 focus:px-4 focus:py-2 focus:rounded">Skip to content</a>
        {% block header %}
        <header
            class="bg-base-100/70 backdrop-blur-xl border-b border-base-300/20 nav-shadow sticky top-0 z-30 transition-all duration-300"
        >
            <div class="navbar container mx-auto px-4 sm:px-6 h-16">
                <div class="flex-1">
                    <a
                        href="/"
                        class="group flex items-center gap-1.5 text-lg font-bold text-base-content tracking-tight hover:text-primary transition-colors duration-300"
                    >
                        <span class="w-7 h-7 rounded-lg bg-gradient-to-br from-primary/15 to-secondary/15 group-hover:from-primary/25 group-hover:to-secondary/25 flex items-center justify-center transition-all duration-300">
                            <i class="ph ph-flower-lotus text-primary text-sm"></i>
                        </span>
                        <span>miniex</span>
                    </a>
                </div>
                <div class="flex-none hidden md:flex items-center">
                    <nav class="flex items-center gap-0.5 bg-base-200/30 rounded-full px-1.5 py-1">
                        <a
                            href="/blog"
                            class="nav-link px-3 py-1.5 text-sm font-medium text-base-content/55 hover:text-primary hover:bg-base-100/80 transition-all duration-200 rounded-full"
                        >{{ t.nav_blog }}</a>
                        <a
                            href="/review"
                            class="nav-link px-3 py-1.5 text-sm font-medium text-base-content/55 hover:text-primary hover:bg-base-100/80 transition-all duration-200 rounded-full"
                        >{{ t.nav_review }}</a>
                        <a
                            href="/diary"
                            class="nav-link px-3 py-1.5 text-sm font-medium text-base-content/55 hover:text-primary hover:bg-base-100/80 transition-all duration-200 rounded-full"
                        >{{ t.nav_diary }}</a>
                        <a
                            href="/series"
                            class="nav-link px-3 py-1.5 text-sm font-medium text-base-content/55 hover:text-primary hover:bg-base-100/80 transition-all duration-200 rounded-full"
                        >{{ t.nav_series }}</a>
                        <a
                            href="/guestbook"
                            class="nav-link px-3 py-1.5 text-sm font-medium text-base-content/55 hover:text-primary hover:bg-base-100/80 transition-all duration-200 rounded-full"
                        >{{ t.nav_guestbook }}</a>
                        <a
                            href="https://miniex.info"
                            class="nav-link px-3 py-1.5 text-sm font-medium text-base-content/55 hover:text-primary hover:bg-base-100/80 transition-all duration-200 rounded-full"
                        >{{ t.nav_about_me }}</a>
                    </nav>
                    <div class="w-px h-5 bg-base-300/40 mx-3"></div>
                    <div class="flex items-center gap-1">
                        <button
                            id="search-btn"
                            class="w-8 h-8 flex items-center justify-center rounded-full text-base-content/45 hover:text-primary hover:bg-primary/8 transition-all duration-200"
                            onclick="document.getElementById('search-modal').showModal()"
                            aria-label="Search"
                        >
                            <i class="ph ph-magnifying-glass text-[17px]"></i>
                        </button>
                        <div class="dropdown dropdown-end">
                            <label
                                tabindex="0"
                                class="w-8 h-8 flex items-center justify-center rounded-full text-base-content/45 hover:text-primary hover:bg-primary/8 transition-all duration-200 cursor-pointer"
                                aria-label="Change language"
                                role="button"
                            >
                                <i class="ph ph-translate text-[17px]"></i>
                            </label>
                            <ul
                                tabindex="0"
                                class="dropdown-content z-[1] menu shadow-xl shadow-base-300/20 bg-base-100 rounded-xl w-36 p-1.5 border border-base-200/50 mt-3"
                            >
                                <li><a href="/api/set-lang?lang=ko" class="rounded-lg text-sm py-2 {% if lang.as_str() == "ko" %}font-semibold text-primary bg-primary/8{% endif %}">한국어</a></li>
                                <li><a href="/api/set-lang?lang=ja" class="rounded-lg text-sm py-2 {% if lang.as_str() == "ja" %}font-semibold text-primary bg-primary/8{% endif %}">日本語</a></li>
                                <li><a href="/api/set-lang?lang=en" class="rounded-lg text-sm py-2 {% if lang.as_str() == "en" %}font-semibold text-primary bg-primary/8{% endif %}">English</a></li>
                            </ul>
                        </div>
                        <button
                            id="theme-toggle"
                            class="w-8 h-8 flex items-center justify-center rounded-full text-base-content/45 hover:text-primary hover:bg-primary/8 transition-all duration-200"
                            aria-label="Toggle theme"
                        >
                            <i class="ph ph-sun text-[17px] theme-light"></i>
                            <i class="ph ph-moon text-[17px] theme-dark hidden"></i>
                        </button>
                    </div>
                </div>
                <div class="flex-none md:hidden flex items-center gap-1">
                    <button
                        class="w-9 h-9 flex items-center justify-center rounded-full text-base-content/50 hover:text-primary hover:bg-primary/8 transition-all duration-200"
                        onclick="document.getElementById('search-modal').showModal()"
                        aria-label="Search"
                    >
                        <i class="ph ph-magnifying-glass text-lg"></i>
                    </button>
                    <label
                        for="drawer"
                        class="w-9 h-9 flex items-center justify-center rounded-full text-base-content/50 hover:text-primary hover:bg-primary/8 transition-all duration-200 cursor-pointer"
                        aria-label="Open menu"
                    >
                        <i class="ph ph-list text-xl"></i>
                    </label>
                </div>
            </div>
        </header>
        {% endblock %}
        <main
            id="main-content"
            class="container mx-auto flex-grow py-6 sm:py-8 md:py-10 px-4 sm:px-6 page-transition"
        >
            {% block main %}{% endblock %}
            <div class="drawer drawer-end">
                <input id="drawer" type="checkbox" class="drawer-toggle" />
                <div class="drawer-side z-40">
                    <label for="drawer" class="drawer-overlay"></label>
                    <div
                        class="px-6 py-6 w-72 sm:w-80 h-full bg-base-100 text-base-content border-l border-base-200/30"
                    >
                        <!-- Drawer header -->
                        <div class="flex items-center justify-between mb-6">
                            <a href="/" class="flex items-center gap-2">
                                <span class="w-8 h-8 rounded-lg bg-gradient-to-br from-primary/15 to-secondary/15 flex items-center justify-center">
                                    <i class="ph ph-flower-lotus text-primary text-sm"></i>
                                </span>
                                <span class="font-bold text-base-content">miniex</span>
                            </a>
                            <label for="drawer" class="w-8 h-8 flex items-center justify-center rounded-full hover:bg-base-200/60 text-base-content/40 cursor-pointer transition-colors">
                                <i class="ph ph-x text-lg"></i>
                            </label>
                        </div>
                        <div class="h-px bg-gradient-to-r from-primary/15 via-secondary/15 to-transparent mb-5"></div>

                        <ul class="menu text-sm gap-0.5 p-0">
                            <li class="menu-title text-[11px] uppercase tracking-[0.15em] text-base-content/35 font-semibold px-3 pt-1 pb-2">{{ t.nav_posts }}</li>
                            <li>
                                <a
                                    href="/blog"
                                    class="rounded-xl hover:bg-primary/6 hover:text-primary transition-all duration-200 px-3 py-2.5 flex items-center gap-2.5"
                                ><i class="ph ph-article text-base text-primary/40"></i>{{ t.nav_blog }}</a>
                            </li>
                            <li>
                                <a
                                    href="/review"
                                    class="rounded-xl hover:bg-primary/6 hover:text-primary transition-all duration-200 px-3 py-2.5 flex items-center gap-2.5"
                                ><i class="ph ph-star text-base text-primary/40"></i>{{ t.nav_review }}</a>
                            </li>
                            <li>
                                <a
                                    href="/diary"
                                    class="rounded-xl hover:bg-primary/6 hover:text-primary transition-all duration-200 px-3 py-2.5 flex items-center gap-2.5"
                                ><i class="ph ph-notebook text-base text-primary/40"></i>{{ t.nav_diary }}</a>
                            </li>
                            <li class="my-2"><div class="h-px bg-base-200/40 mx-3"></div></li>
                            <li>
                                <a
                                    href="/series"
                                    class="rounded-xl hover:bg-primary/6 hover:text-primary transition-all duration-200 px-3 py-2.5 flex items-center gap-2.5"
                                ><i class="ph ph-books text-base text-primary/40"></i>{{ t.nav_series }}</a>
                            </li>
                            <li>
                                <a
                                    href="/guestbook"
                                    class="rounded-xl hover:bg-primary/6 hover:text-primary transition-all duration-200 px-3 py-2.5 flex items-center gap-2.5"
                                ><i class="ph ph-chat-circle text-base text-primary/40"></i>{{ t.nav_guestbook }}</a>
                            </li>
                            <li>
                                <a
                                    href="https://miniex.info"
                                    class="rounded-xl hover:bg-primary/6 hover:text-primary transition-all duration-200 px-3 py-2.5 flex items-center gap-2.5"
                                ><i class="ph ph-user-circle text-base text-primary/40"></i>{{ t.nav_about_me }}</a>
                            </li>
                            <li class="my-2"><div class="h-px bg-base-200/40 mx-3"></div></li>
                            <li>
                                <details>
                                    <summary
                                        class="rounded-xl hover:bg-primary/6 hover:text-primary transition-all duration-200 px-3 py-2.5"
                                    >
                                        <i class="ph ph-translate text-base text-primary/40"></i>
                                        {{ t.lang_switch_label }}
                                    </summary>
                                    <ul class="mt-1 ml-2 before:hidden">
                                        <li><a href="/api/set-lang?lang=ko" class="rounded-lg text-sm py-2 {% if lang.as_str() == "ko" %}font-semibold text-primary{% endif %}">한국어</a></li>
                                        <li><a href="/api/set-lang?lang=ja" class="rounded-lg text-sm py-2 {% if lang.as_str() == "ja" %}font-semibold text-primary{% endif %}">日本語</a></li>
                                        <li><a href="/api/set-lang?lang=en" class="rounded-lg text-sm py-2 {% if lang.as_str() == "en" %}font-semibold text-primary{% endif %}">English</a></li>
                                    </ul>
                                </details>
                            </li>
                            <li class="mt-1">
                                <button
                                    id="theme-toggle-mobile"
                                    class="rounded-xl hover:bg-primary/6 hover:text-primary transition-all duration-200 flex items-center gap-2.5 px-3 py-2.5"
                                >
                                    <i class="ph ph-sun text-base text-primary/40 theme-light"></i>
                                    <i class="ph ph-moon text-base text-primary/40 theme-dark hidden"></i>
                                    <span class="theme-light">{{ t.nav_light_mode }}</span>
                                    <span class="theme-dark hidden">{{ t.nav_dark_mode }}</span>
                                </button>
                            </li>
                        </ul>

                        <!-- Drawer footer -->
                        <div class="absolute bottom-6 left-6 right-6">
                            <div class="h-px bg-base-200/30 mb-4"></div>
                            <div class="flex items-center justify-center gap-2">
                                <a href="https://github.com/miniex" class="w-9 h-9 rounded-xl bg-base-200/40 hover:bg-primary/10 flex items-center justify-center text-base-content/35 hover:text-primary transition-all duration-200" aria-label="GitHub">
                                    <i class="ph ph-github-logo text-base"></i>
                                </a>
                                <a href="mailto:miniex@daminstudio.net" class="w-9 h-9 rounded-xl bg-base-200/40 hover:bg-primary/10 flex items-center justify-center text-base-content/35 hover:text-primary transition-all duration-200" aria-label="Email">
                                    <i class="ph ph-envelope text-base"></i>
                                </a>
                                <a href="https://miniex.info" class="w-9 h-9 rounded-xl bg-base-200/40 hover:bg-primary/10 flex items-center justify-center text-base-content/35 hover:text-primary transition-all duration-200" aria-label="Website">
                                    <i class="ph ph-globe text-base"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
        {% block footer %}
        <footer class="relative mt-8">
            <!-- Top accent -->
            <div class="h-px bg-gradient-to-r from-transparent via-base-300/40 to-transparent"></div>

            <div class="container mx-auto px-4 sm:px-6 py-8 sm:py-10">
                <div class="flex flex-col gap-6">
                    <!-- Top row: brand + nav -->
                    <div class="flex flex-col sm:flex-row items-center sm:items-start justify-between gap-6">
                        <!-- Brand -->
                        <div class="flex flex-col items-center sm:items-start gap-2">
                            <a href="/" class="flex items-center gap-2 group">
                                <span class="w-7 h-7 rounded-lg bg-gradient-to-br from-primary/12 to-secondary/12 group-hover:from-primary/20 group-hover:to-secondary/20 flex items-center justify-center transition-all duration-300">
                                    <i class="ph ph-flower-lotus text-primary/70 text-sm"></i>
                                </span>
                                <span class="font-bold text-base-content/80 text-sm">miniex</span>
                            </a>
                            <p class="text-xs text-base-content/30 max-w-[200px] text-center sm:text-left leading-relaxed">A personal dev blog by Han Damin</p>
                        </div>

                        <!-- Nav links -->
                        <nav class="flex flex-wrap justify-center gap-x-5 gap-y-2 text-xs text-base-content/40">
                            <a href="/blog" class="hover:text-primary transition-colors duration-200">{{ t.nav_blog }}</a>
                            <a href="/review" class="hover:text-primary transition-colors duration-200">{{ t.nav_review }}</a>
                            <a href="/diary" class="hover:text-primary transition-colors duration-200">{{ t.nav_diary }}</a>
                            <a href="/series" class="hover:text-primary transition-colors duration-200">{{ t.nav_series }}</a>
                            <a href="/guestbook" class="hover:text-primary transition-colors duration-200">{{ t.nav_guestbook }}</a>
                            <a href="/feed.xml" class="hover:text-primary transition-colors duration-200">RSS</a>
                        </nav>
                    </div>

                    <!-- Divider -->
                    <div class="h-px bg-base-300/20"></div>

                    <!-- Visitor stats -->
                    <div class="flex items-center justify-center gap-4 text-xs text-base-content/35">
                        <div class="flex items-center gap-1.5">
                            <span class="relative flex h-2 w-2">
                                <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-success/60 opacity-75"></span>
                                <span class="relative inline-flex rounded-full h-2 w-2 bg-success/80"></span>
                            </span>
                            <span>{{ t.visitor_today }}</span>
                            <span id="visitor-today" class="font-medium text-base-content/50">&mdash;</span>
                        </div>
                        <div class="flex items-center gap-1.5">
                            <i class="ph ph-users text-xs"></i>
                            <span>{{ t.visitor_total }}</span>
                            <span id="visitor-total" class="font-medium text-base-content/50">&mdash;</span>
                        </div>
                    </div>

                    <!-- Bottom row: social + copyright -->
                    <div class="flex flex-col sm:flex-row items-center justify-between gap-3">
                        <div class="flex items-center gap-1.5">
                            <a href="https://github.com/miniex" class="w-8 h-8 rounded-full bg-base-200/30 hover:bg-primary/10 flex items-center justify-center text-base-content/30 hover:text-primary transition-all duration-200" aria-label="GitHub">
                                <i class="ph ph-github-logo text-sm"></i>
                            </a>
                            <a href="mailto:miniex@daminstudio.net" class="w-8 h-8 rounded-full bg-base-200/30 hover:bg-primary/10 flex items-center justify-center text-base-content/30 hover:text-primary transition-all duration-200" aria-label="Email">
                                <i class="ph ph-envelope text-sm"></i>
                            </a>
                            <a href="https://miniex.info" class="w-8 h-8 rounded-full bg-base-200/30 hover:bg-primary/10 flex items-center justify-center text-base-content/30 hover:text-primary transition-all duration-200" aria-label="Website">
                                <i class="ph ph-globe text-sm"></i>
                            </a>
                        </div>
                        <span class="text-[11px] text-base-content/25">{{ t.footer_copyright }}</span>
                    </div>
                </div>
            </div>
        </footer>
        {% endblock %}

        <!-- Search Modal -->
        <dialog id="search-modal" class="modal modal-bottom sm:modal-middle">
            <div class="modal-box sm:rounded-3xl p-0 overflow-hidden border border-base-300/30 shadow-2xl max-w-lg">
                <!-- Search header -->
                <div class="relative bg-base-100 p-4 border-b border-base-200/60">
                    <div class="flex items-center gap-3">
                        <div class="flex-shrink-0 w-9 h-9 rounded-xl bg-gradient-to-br from-primary/10 to-secondary/10 flex items-center justify-center">
                            <i class="ph ph-magnifying-glass text-base text-primary"></i>
                        </div>
                        <input
                            id="search-input"
                            class="flex-1 bg-transparent text-base outline-none placeholder:text-base-content/35"
                            placeholder="{{ t.search_placeholder }}"
                            autocomplete="off"
                        />
                        <button
                            id="search-lang-badge"
                            class="flex-shrink-0 badge badge-sm cursor-pointer select-none bg-gradient-to-r from-primary/80 to-secondary/80 text-primary-content border-none font-medium px-2.5 py-2.5 hover:opacity-80 transition-opacity duration-200"
                            data-lang="{{ lang.as_str() }}"
                        >
                            {{ lang.as_str()|upper }}
                        </button>
                    </div>
                </div>

                <!-- Search results -->
                <div id="search-results" class="max-h-[60vh] overflow-y-auto hidden bg-base-100/50"></div>

                <!-- Search footer -->
                <div class="flex items-center justify-between px-4 py-2.5 bg-base-200/30 border-t border-base-200/60 text-xs text-base-content/40">
                    <div class="flex items-center gap-3">
                        <span class="flex items-center gap-1">
                            <kbd class="kbd kbd-xs bg-base-200/60 border-base-300/30 px-1 min-h-0 h-4 text-[10px]">↑</kbd>
                            <kbd class="kbd kbd-xs bg-base-200/60 border-base-300/30 px-1 min-h-0 h-4 text-[10px]">↓</kbd>
                            navigate
                        </span>
                        <span class="flex items-center gap-1">
                            <kbd class="kbd kbd-xs bg-base-200/60 border-base-300/30 px-1 min-h-0 h-4 text-[10px]">↵</kbd>
                            open
                        </span>
                    </div>
                    <form method="dialog" class="inline">
                        <button class="flex items-center gap-1 hover:text-base-content/60 transition-colors">
                            <kbd class="kbd kbd-xs bg-base-200/60 border-base-300/30 px-1 min-h-0 h-4 text-[10px]">esc</kbd>
                            close
                        </button>
                    </form>
                </div>
            </div>
            <form method="dialog" class="modal-backdrop bg-black/40 backdrop-blur-sm"><button aria-label="Close search">close</button></form>
        </dialog>

        <!-- i18n data for JS -->
        <script id="i18n-data" type="application/json">
        {
            "code_copy": "{{ t.code_copy }}",
            "code_copied": "{{ t.code_copied }}",
            "search_placeholder": "{{ t.search_placeholder }}",
            "search_no_results": "{{ t.search_no_results }}",
            "search_results_for": "{{ t.search_results_for }}",
            "card_read_more": "{{ t.card_read_more }}",
            "post_min_read": "{{ t.post_min_read }}",
            "comments_enter_both": "{{ t.comments_enter_both }}",
            "comments_failed_create": "{{ t.comments_failed_create }}",
            "comments_error": "{{ t.comments_error }}",
            "comments_be_first": "{{ t.comments_be_first }}",
            "comments_enter_password_edit": "{{ t.comments_enter_password_edit }}",
            "comments_edit_prompt": "{{ t.comments_edit_prompt }}",
            "comments_wrong_password": "{{ t.comments_wrong_password }}",
            "comments_failed_edit": "{{ t.comments_failed_edit }}",
            "comments_enter_password_delete": "{{ t.comments_enter_password_delete }}",
            "comments_confirm_delete": "{{ t.comments_confirm_delete }}",
            "guestbook_enter_both": "{{ t.guestbook_enter_both }}",
            "guestbook_failed": "{{ t.guestbook_failed }}",
            "graph_before": "{{ t.graph_before }}",
            "graph_after": "{{ t.graph_after }}",
            "post_views": "{{ t.post_views }}",
            "post_likes": "{{ t.post_likes }}",
            "visitor_today": "{{ t.visitor_today }}",
            "visitor_total": "{{ t.visitor_total }}",
            "visitor_visitors": "{{ t.visitor_visitors }}",
            "rate_limit": "{{ t.rate_limit }}"
        }
        </script>
        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-XRQ5DNK9X4"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag() { dataLayer.push(arguments); }
            gtag("js", new Date());
            gtag("config", "G-XRQ5DNK9X4");
        </script>

        <script src="/assets/js/search.js?v={{ blog.v }}" defer></script>
        <script src="/assets/js/visitor.js?v={{ blog.v }}" defer></script>
    </body>
</html>
