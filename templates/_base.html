<!doctype html>
<html
    lang="{{ lang.as_str() }}"
    data-theme="pastel"
    class="scroll-smooth transition-colors duration-300"
>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <script>
            (function(){var t=localStorage.getItem("theme");if(t==="dark"||t==="pastel-dark"||((!t)&&window.matchMedia("(prefers-color-scheme:dark)").matches)){document.documentElement.setAttribute("data-theme","pastel-dark")}})();
        </script>
        <script src="https://unpkg.com/htmx.org@2.0.2" defer></script>
        <script src="https://unpkg.com/@phosphor-icons/web" defer></script>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link
            href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;500;600;700&family=Gowun+Dodum&family=Zen+Maru+Gothic:wght@300;400;500;700&family=JetBrains+Mono:wght@400;500&display=swap"
            rel="stylesheet"
            media="print" onload="this.media='all'"
        />
        <noscript>
            <link
                href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;500;600;700&family=Gowun+Dodum&family=Zen+Maru+Gothic:wght@300;400;500;700&family=JetBrains+Mono:wght@400;500&display=swap"
                rel="stylesheet"
            />
        </noscript>
        <link href="/assets/styles/tailwind.output.css?v=12" rel="stylesheet" />
        <link href="/assets/styles/global.css?v=12" rel="stylesheet" />
        <link
            rel="stylesheet"
            href="/assets/styles/print.css?v=2"
            media="print"
        />
        <!-- highlight.js -->
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-light.min.css"
            media="print" onload="this.media='all'"
        />
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/rust.min.js" defer></script>
        <script src="/assets/js/code-highlight.js?v=3" defer></script>
        <!-- Atom feed autodiscovery -->
        <link rel="alternate" type="application/atom+xml" title="miniex.blog" href="/feed.xml" />
        <!-- each page -->
        {% block head %}{% endblock %}
        <!-- favicon -->
        <link
            rel="apple-touch-icon-precomposed"
            sizes="152x152"
            href="/assets/favicon/sakura-flower-152-238032.png"
        />
        <link
            rel="apple-touch-icon-precomposed"
            sizes="144x144"
            href="/assets/favicon/sakura-flower-152-238032.png"
        />
        <link
            rel="apple-touch-icon-precomposed"
            sizes="120x120"
            href="/assets/favicon/sakura-flower-152-238032.png"
        />
        <link
            rel="apple-touch-icon-precomposed"
            sizes="114x114"
            href="/assets/favicon/sakura-flower-152-238032.png"
        />
        <link
            rel="apple-touch-icon-precomposed"
            sizes="72x72"
            href="/assets/favicon/sakura-flower-152-238032.png"
        />
        <link
            rel="apple-touch-icon-precomposed"
            href="/assets/favicon/sakura-flower-152-238032.png"
        />
        <link
            rel="icon"
            href="/assets/favicon/sakura-flower-152-238032.png"
            sizes="32x32"
        />
        <link rel="shortcut icon" href="/assets/favicon/favicon.ico" />
        <!-- Google tag (gtag.js) -->
        <script
            async
            src="https://www.googletagmanager.com/gtag/js?id=G-XRQ5DNK9X4"
        ></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag() {
                dataLayer.push(arguments);
            }
            gtag("js", new Date());

            gtag("config", "G-XRQ5DNK9X4");
        </script>
        <!-- i18n data for JS -->
        <script id="i18n-data" type="application/json">
        {
            "code_copy": "{{ t.code_copy }}",
            "code_copied": "{{ t.code_copied }}",
            "search_placeholder": "{{ t.search_placeholder }}",
            "search_no_results": "{{ t.search_no_results }}",
            "search_results_for": "{{ t.search_results_for }}",
            "card_read_more": "{{ t.card_read_more }}",
            "post_min_read": "{{ t.post_min_read }}",
            "comments_enter_both": "{{ t.comments_enter_both }}",
            "comments_failed_create": "{{ t.comments_failed_create }}",
            "comments_error": "{{ t.comments_error }}",
            "comments_be_first": "{{ t.comments_be_first }}",
            "comments_enter_password_edit": "{{ t.comments_enter_password_edit }}",
            "comments_edit_prompt": "{{ t.comments_edit_prompt }}",
            "comments_wrong_password": "{{ t.comments_wrong_password }}",
            "comments_failed_edit": "{{ t.comments_failed_edit }}",
            "comments_enter_password_delete": "{{ t.comments_enter_password_delete }}",
            "comments_confirm_delete": "{{ t.comments_confirm_delete }}",
            "guestbook_enter_both": "{{ t.guestbook_enter_both }}",
            "guestbook_failed": "{{ t.guestbook_failed }}",
            "graph_before": "{{ t.graph_before }}",
            "graph_after": "{{ t.graph_after }}"
        }
        </script>
        <style>
            /* Custom transitions and animations */
            .page-transition {
                animation: fadeIn 0.4s ease-out;
            }

            @keyframes fadeIn {
                from {
                    opacity: 0;
                    transform: translateY(8px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }

            .nav-shadow {
                transition: box-shadow 0.3s ease, border-color 0.3s ease;
            }

            /* Custom scrollbar */
            ::-webkit-scrollbar {
                width: 6px;
                height: 6px;
            }

            ::-webkit-scrollbar-track {
                background: transparent;
            }

            ::-webkit-scrollbar-thumb {
                background: rgba(201, 137, 158, 0.18);
                border-radius: 3px;
            }

            ::-webkit-scrollbar-thumb:hover {
                background: rgba(201, 137, 158, 0.3);
            }
        </style>
    </head>

    <body
        class="flex flex-col min-h-screen bg-base-100 font-['Nunito','Gowun_Dodum','Zen_Maru_Gothic',system-ui,sans-serif] text-base-content antialiased selection:bg-primary/15 selection:text-base-content"
    >
        <a href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-2 focus:left-2 focus:z-50 focus:bg-base-100 focus:px-4 focus:py-2 focus:rounded">Skip to content</a>
        {% block header %}
        <header
            class="bg-base-100/70 backdrop-blur-xl border-b border-base-300/30 nav-shadow sticky top-0 z-30 transition-all duration-300"
        >
            <div class="navbar container mx-auto px-4 sm:px-6 h-16">
                <div class="flex-1">
                    <a
                        href="/"
                        class="text-lg font-bold text-base-content tracking-tight hover:opacity-70 transition-opacity duration-200"
                    ><i class="ph ph-flower-lotus text-primary/60 text-sm mr-1"></i>miniex</a>
                </div>
                <div class="flex-none hidden md:flex items-center">
                    <nav class="flex items-center gap-1">
                        <a
                            href="/blog"
                            class="px-3 py-2 text-sm font-medium text-base-content/60 hover:text-primary hover:bg-primary/5 transition-colors duration-200 rounded-lg"
                        >{{ t.nav_blog }}</a>
                        <a
                            href="/review"
                            class="px-3 py-2 text-sm font-medium text-base-content/60 hover:text-primary hover:bg-primary/5 transition-colors duration-200 rounded-lg"
                        >{{ t.nav_review }}</a>
                        <a
                            href="/diary"
                            class="px-3 py-2 text-sm font-medium text-base-content/60 hover:text-primary hover:bg-primary/5 transition-colors duration-200 rounded-lg"
                        >{{ t.nav_diary }}</a>
                        <a
                            href="/series"
                            class="px-3 py-2 text-sm font-medium text-base-content/60 hover:text-primary hover:bg-primary/5 transition-colors duration-200 rounded-lg"
                        >{{ t.nav_series }}</a>
                        <a
                            href="/guestbook"
                            class="px-3 py-2 text-sm font-medium text-base-content/60 hover:text-primary hover:bg-primary/5 transition-colors duration-200 rounded-lg"
                        >{{ t.nav_guestbook }}</a>
                        <a
                            href="https://miniex.info"
                            class="px-3 py-2 text-sm font-medium text-base-content/60 hover:text-primary hover:bg-primary/5 transition-colors duration-200 rounded-lg"
                        >{{ t.nav_about_me }}</a>
                    </nav>
                    <div class="w-px h-5 bg-base-300/60 mx-2"></div>
                    <div class="flex items-center gap-0.5">
                        <button
                            id="search-btn"
                            class="btn btn-ghost btn-sm btn-circle text-base-content/60 hover:text-base-content hover:bg-primary/8 transition-all duration-200"
                            onclick="document.getElementById('search-modal').showModal()"
                            aria-label="Search"
                        >
                            <i class="ph ph-magnifying-glass text-lg"></i>
                        </button>
                        <div class="dropdown dropdown-end">
                            <label
                                tabindex="0"
                                class="btn btn-ghost btn-sm btn-circle text-base-content/60 hover:text-base-content hover:bg-primary/8 transition-all duration-200"
                                aria-label="Change language"
                                role="button"
                            >
                                <i class="ph ph-translate text-lg"></i>
                            </label>
                            <ul
                                tabindex="0"
                                class="dropdown-content z-[1] menu shadow-lg bg-base-100 rounded-lg w-36 p-1 border border-base-200/60 mt-2"
                            >
                                <li><a href="/api/set-lang?lang=ko" class="rounded-md text-sm py-2 {% if lang.as_str() == "ko" %}font-semibold text-primary bg-primary/8{% endif %}">한국어</a></li>
                                <li><a href="/api/set-lang?lang=ja" class="rounded-md text-sm py-2 {% if lang.as_str() == "ja" %}font-semibold text-primary bg-primary/8{% endif %}">日本語</a></li>
                                <li><a href="/api/set-lang?lang=en" class="rounded-md text-sm py-2 {% if lang.as_str() == "en" %}font-semibold text-primary bg-primary/8{% endif %}">English</a></li>
                            </ul>
                        </div>
                        <button
                            id="theme-toggle"
                            class="btn btn-ghost btn-sm btn-circle text-base-content/60 hover:text-base-content hover:bg-primary/8 transition-all duration-200"
                            aria-label="Toggle theme"
                        >
                            <i class="ph ph-sun text-lg theme-light"></i>
                            <i class="ph ph-moon text-lg theme-dark hidden"></i>
                        </button>
                    </div>
                </div>
                <div class="flex-none md:hidden flex items-center gap-0.5">
                    <button
                        class="btn btn-ghost btn-sm btn-circle text-base-content/60 hover:text-base-content hover:bg-primary/8 transition-all duration-200"
                        onclick="document.getElementById('search-modal').showModal()"
                        aria-label="Search"
                    >
                        <i class="ph ph-magnifying-glass text-lg"></i>
                    </button>
                    <label
                        for="drawer"
                        class="btn btn-ghost btn-sm btn-circle text-base-content/60 hover:text-base-content hover:bg-primary/8 transition-all duration-200"
                        aria-label="Open menu"
                    >
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            fill="none"
                            viewBox="0 0 24 24"
                            class="inline-block w-5 h-5 stroke-current"
                        >
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M4 6h16M4 12h16M4 18h16"
                            ></path>
                        </svg>
                    </label>
                </div>
            </div>
        </header>
        {% endblock %}
        <main
            id="main-content"
            class="container mx-auto flex-grow py-6 sm:py-8 md:py-10 px-4 sm:px-6 page-transition"
        >
            {% block main %}{% endblock %}
            <div class="drawer drawer-end">
                <input id="drawer" type="checkbox" class="drawer-toggle" />
                <div class="drawer-side z-40">
                    <label for="drawer" class="drawer-overlay"></label>
                    <div
                        class="px-6 py-8 w-72 sm:w-80 h-full bg-base-100 text-base-content border-l border-base-200/50"
                    >
                        <div class="h-1 bg-gradient-to-r from-primary/20 via-secondary/20 to-accent/20 -mx-6 -mt-8 mb-6 rounded-none"></div>
                        <ul class="menu text-sm gap-1 p-0">
                            <li class="menu-title text-xs uppercase tracking-wider text-base-content/40 px-3 pt-2 pb-1">{{ t.nav_posts }}</li>
                            <li>
                                <a
                                    href="/blog"
                                    class="rounded-lg hover:bg-primary/5 transition-colors px-3 py-2.5"
                                >{{ t.nav_blog }}</a>
                            </li>
                            <li>
                                <a
                                    href="/review"
                                    class="rounded-lg hover:bg-primary/5 transition-colors px-3 py-2.5"
                                >{{ t.nav_review }}</a>
                            </li>
                            <li>
                                <a
                                    href="/diary"
                                    class="rounded-lg hover:bg-primary/5 transition-colors px-3 py-2.5"
                                >{{ t.nav_diary }}</a>
                            </li>
                            <li class="mt-2"><div class="border-t border-base-200/50 mx-3"></div></li>
                            <li>
                                <a
                                    href="/series"
                                    class="rounded-lg hover:bg-primary/5 transition-colors px-3 py-2.5"
                                >{{ t.nav_series }}</a>
                            </li>
                            <li>
                                <a
                                    href="/guestbook"
                                    class="rounded-lg hover:bg-primary/5 transition-colors px-3 py-2.5"
                                >{{ t.nav_guestbook }}</a>
                            </li>
                            <li>
                                <a
                                    href="https://miniex.info"
                                    class="rounded-lg hover:bg-primary/5 transition-colors px-3 py-2.5"
                                >{{ t.nav_about_me }}</a>
                            </li>
                            <li class="mt-2"><div class="border-t border-base-200/50 mx-3"></div></li>
                            <li>
                                <details>
                                    <summary
                                        class="rounded-lg hover:bg-primary/5 transition-colors px-3 py-2.5"
                                    >
                                        <i class="ph ph-translate text-base"></i>
                                        {{ t.lang_switch_label }}
                                    </summary>
                                    <ul class="mt-1 ml-2 before:hidden">
                                        <li><a href="/api/set-lang?lang=ko" class="rounded-md text-sm py-2 {% if lang.as_str() == "ko" %}font-semibold text-primary{% endif %}">한국어</a></li>
                                        <li><a href="/api/set-lang?lang=ja" class="rounded-md text-sm py-2 {% if lang.as_str() == "ja" %}font-semibold text-primary{% endif %}">日本語</a></li>
                                        <li><a href="/api/set-lang?lang=en" class="rounded-md text-sm py-2 {% if lang.as_str() == "en" %}font-semibold text-primary{% endif %}">English</a></li>
                                    </ul>
                                </details>
                            </li>
                            <li class="mt-3">
                                <button
                                    id="theme-toggle-mobile"
                                    class="rounded-lg hover:bg-primary/5 transition-colors flex items-center gap-2 px-3 py-2.5"
                                >
                                    <i
                                        class="ph ph-sun text-base theme-light"
                                    ></i>
                                    <i
                                        class="ph ph-moon text-base theme-dark hidden"
                                    ></i>
                                    <span class="theme-light">{{ t.nav_light_mode }}</span>
                                    <span class="theme-dark hidden"
                                        >{{ t.nav_dark_mode }}</span
                                    >
                                </button>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </main>
        {% block footer %}
        <footer
            class="border-t border-base-300/30"
        >
            <div class="container mx-auto px-4 sm:px-6 py-6">
                <div class="flex flex-col sm:flex-row items-center justify-between gap-4">
                    <div class="flex items-center gap-4 text-sm text-base-content/50">
                        <a href="/blog" class="hover:text-base-content transition-colors duration-200">{{ t.nav_blog }}</a>
                        <a href="/review" class="hover:text-base-content transition-colors duration-200">{{ t.nav_review }}</a>
                        <a href="/diary" class="hover:text-base-content transition-colors duration-200">{{ t.nav_diary }}</a>
                        <a href="/series" class="hover:text-base-content transition-colors duration-200">{{ t.nav_series }}</a>
                        <a href="/guestbook" class="hover:text-base-content transition-colors duration-200">{{ t.nav_guestbook }}</a>
                    </div>
                    <div class="flex items-center gap-3">
                        <div class="flex items-center gap-1">
                            <a
                                href="https://github.com/miniex"
                                class="btn btn-ghost btn-xs btn-circle text-base-content/40 hover:text-primary transition-colors duration-200"
                                aria-label="GitHub"
                            >
                                <i class="ph ph-github-logo text-base"></i>
                            </a>
                            <a
                                href="mailto:miniex@daminstudio.net"
                                class="btn btn-ghost btn-xs btn-circle text-base-content/40 hover:text-primary transition-colors duration-200"
                                aria-label="Email"
                            >
                                <i class="ph ph-envelope text-base"></i>
                            </a>
                            <a
                                href="https://miniex.info"
                                class="btn btn-ghost btn-xs btn-circle text-base-content/40 hover:text-primary transition-colors duration-200"
                                aria-label="Website"
                            >
                                <i class="ph ph-globe text-base"></i>
                            </a>
                        </div>
                        <span class="text-xs text-base-content/25">{{ t.footer_copyright }}</span>
                    </div>
                </div>
            </div>
        </footer>
        {% endblock %}

        <!-- Search Modal -->
        <dialog id="search-modal" class="modal modal-bottom sm:modal-middle">
            <div class="modal-box sm:rounded-3xl p-0 overflow-hidden border border-base-300/30 shadow-2xl max-w-lg">
                <!-- Search header -->
                <div class="relative bg-base-100 p-4 border-b border-base-200/60">
                    <div class="flex items-center gap-3">
                        <div class="flex-shrink-0 w-9 h-9 rounded-xl bg-gradient-to-br from-primary/10 to-secondary/10 flex items-center justify-center">
                            <i class="ph ph-magnifying-glass text-base text-primary"></i>
                        </div>
                        <input
                            id="search-input"
                            class="flex-1 bg-transparent text-base outline-none placeholder:text-base-content/35"
                            placeholder="{{ t.search_placeholder }}"
                            autocomplete="off"
                        />
                        <button
                            id="search-lang-badge"
                            class="flex-shrink-0 badge badge-sm cursor-pointer select-none bg-gradient-to-r from-primary/80 to-secondary/80 text-primary-content border-none font-medium px-2.5 py-2.5 hover:opacity-80 transition-opacity duration-200"
                            data-lang="{{ lang.as_str() }}"
                        >
                            {{ lang.as_str()|upper }}
                        </button>
                    </div>
                </div>

                <!-- Search results -->
                <div id="search-results" class="max-h-[60vh] overflow-y-auto hidden bg-base-100/50"></div>

                <!-- Search footer -->
                <div class="flex items-center justify-between px-4 py-2.5 bg-base-200/30 border-t border-base-200/60 text-xs text-base-content/40">
                    <div class="flex items-center gap-3">
                        <span class="flex items-center gap-1">
                            <kbd class="kbd kbd-xs bg-base-200/60 border-base-300/30 px-1 min-h-0 h-4 text-[10px]">↑</kbd>
                            <kbd class="kbd kbd-xs bg-base-200/60 border-base-300/30 px-1 min-h-0 h-4 text-[10px]">↓</kbd>
                            navigate
                        </span>
                        <span class="flex items-center gap-1">
                            <kbd class="kbd kbd-xs bg-base-200/60 border-base-300/30 px-1 min-h-0 h-4 text-[10px]">↵</kbd>
                            open
                        </span>
                    </div>
                    <form method="dialog" class="inline">
                        <button class="flex items-center gap-1 hover:text-base-content/60 transition-colors">
                            <kbd class="kbd kbd-xs bg-base-200/60 border-base-300/30 px-1 min-h-0 h-4 text-[10px]">esc</kbd>
                            close
                        </button>
                    </form>
                </div>
            </div>
            <form method="dialog" class="modal-backdrop bg-black/40 backdrop-blur-sm"><button aria-label="Close search">close</button></form>
        </dialog>

        <script src="/assets/js/search.js?v=1" defer></script>

        <script>
            // Add shadow to header on scroll
            window.addEventListener("scroll", function () {
                const header = document.querySelector("header");
                if (window.scrollY > 10) {
                    header.classList.add("shadow-md");
                } else {
                    header.classList.remove("shadow-md");
                }
            }, { passive: true });

            // Theme toggle functionality
            document.addEventListener("DOMContentLoaded", function () {
                // Get theme toggles and html element
                const themeToggle = document.getElementById("theme-toggle");
                const themeToggleMobile = document.getElementById(
                    "theme-toggle-mobile",
                );
                const html = document.documentElement;

                // Check for saved theme preference or use system preference
                const savedTheme = localStorage.getItem("theme");
                const systemDarkMode = window.matchMedia(
                    "(prefers-color-scheme: dark)",
                ).matches;

                // Apply theme on initial load
                if (savedTheme === "dark" || savedTheme === "pastel-dark" || (!savedTheme && systemDarkMode)) {
                    applyTheme("pastel-dark");
                } else {
                    applyTheme("pastel");
                }

                // Toggle theme on button click
                themeToggle.addEventListener("click", () => {
                    const currentTheme = html.getAttribute("data-theme");
                    const newTheme =
                        currentTheme === "pastel-dark" ? "pastel" : "pastel-dark";
                    applyTheme(newTheme);
                });

                themeToggleMobile.addEventListener("click", () => {
                    const currentTheme = html.getAttribute("data-theme");
                    const newTheme =
                        currentTheme === "pastel-dark" ? "pastel" : "pastel-dark";
                    applyTheme(newTheme);
                });

                // Function to apply theme
                function applyTheme(theme) {
                    html.setAttribute("data-theme", theme);
                    localStorage.setItem("theme", theme);

                    // Update toggle visibility
                    const lightElements =
                        document.querySelectorAll(".theme-light");
                    const darkElements =
                        document.querySelectorAll(".theme-dark");

                    if (theme === "pastel-dark") {
                        lightElements.forEach((el) =>
                            el.classList.add("hidden"),
                        );
                        darkElements.forEach((el) =>
                            el.classList.remove("hidden"),
                        );
                    } else {
                        lightElements.forEach((el) =>
                            el.classList.remove("hidden"),
                        );
                        darkElements.forEach((el) =>
                            el.classList.add("hidden"),
                        );
                    }
                }
            });
        </script>
    </body>
</html>
